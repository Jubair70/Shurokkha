{% extends 'base_test.html' %}
<head>
    <meta charset="utf-8"/>
    <title>{% block title %} Para Vet Details {% endblock %}</title>
</head>
{% load i18n %}
{% block additional-headers %}
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css">
    <link href="https://cdn.datatables.net/buttons/1.4.2/css/buttons.dataTables.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/semantic-ui/2.2.10/semantic.min.css">
    <link href="/static/css/calendar.min.css" rel="stylesheet" type="text/css"/>
    <link href="/static/bootstrap4/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom fonts for this template-->
    <link href="/static/bootstrap4/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <!-- Custom styles for this template-->
    <link href="/static/bootstrap4/css/sb-admin.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" media="all"
              href="/static/css/Date-Range-Picker-For-Twitter-Bootstrap/daterangepicker.css">




    <style>

        .sms-dashboard-div {
            padding-left: 0px;
        }

        .btn-color {
            background-color: #00B755;
            border: #00B755;
        }

        img, img.scale-with-grid {
            outline: 0;
            max-width: 100%;
            height: auto;
        }

        .ui-datepicker-calendar {
            display: none;
        }

    </style>


{% endblock %}



{% block content %}
    <div class="portlet box red">
        <div class="portlet-title">
            <div class="caption"><i class="fa fa-adn"></i> Para Vet Details</div>
        </div>
        {% csrf_token %}
        <div class="portlet-body">


            <div class="row mt-1">

                <div class="col-sm-3 col-md-3  ">
                    <img src="/media/p.jpg">

                </div>
                <div class="col-md-8 ">

                    <div class=" row ">
                        <div class="col-md-4 mb-3">
                            <span>Name : </span>

                        </div>
                        <span>{{ get_para_vet_info.0.0 }}</span>
                    </div>
                    <div class=" row ">
                        <div class="col-md-4 mb-3 ">
                            <span>District : </span>

                        </div>

                        <span>{{ get_para_vet_info.0.1 }}</span>
                    </div>

                    <div class=" row ">


                        <div class="col-md-4">
                            <span>No. of cases Reported : </span>

                        </div>

                        <span>to</span>

                    </div>

                </div>


            </div>


            <div class="row mt-3">


                <div class="col-md-3 input-group "><label class="control-label mt-1"> Date range</label><br>
                    <input class="form-control ml-3 " readonly type="text" name="reservation" id="date_range"/>
                </div>

                <div class="col-md-2">
                    <button class="btn btn-info pull-left btn-color " id="no_of_cases_report" name="no_of_cases_report"
                            data-original-title=""
                            title="" onclick="get_chart_data() ">No. of Cases Reported
                    </button>
                </div>
                <div class="col-md-2">
                    <button class="btn btn-info pull-left btn-color " id="tat_report" name="tat_report"
                            data-original-title=""
                            title="" onclick="get_chart_data() ">TAT
                    </button>

                </div>

            </div>


            <div class="row mt-4">

                <div id="para_vat_chart_individual" class="col-sm-12 col-md-12  ">

                </div>


            </div>


            <!-- /.container-fluid-->
            <!-- /.content-wrapper-->
            <!-- Scroll to Top Button-->
            <!-- Bootstrap core JavaScript-->
        </div>
    </div>

{% endblock %}
{% block additional-javascript %}
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.2/js/dataTables.buttons.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.2/js/buttons.flash.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/pdfmake.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/vfs_fonts.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.2/js/buttons.html5.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.2/js/buttons.print.min.js"></script>
    <script src="https://cdn.jsdelivr.net/semantic-ui/2.2.10/semantic.min.js"></script>
        <script type="text/javascript" src="/static/js/calendar.min.js"></script>
        <script type="text/javascript" src="/static/js/Date-Range-Picker-For-Twitter-Bootstrap/date.js"></script>
        <script type="text/javascript" src="/static/js/Date-Range-Picker-For-Twitter-Bootstrap/daterangepicker.js"></script>

    <script src="http://code.highcharts.com/highcharts.js"></script>
    <script type="text/javascript" src="http://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/highcharts-more.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>

    <script>


        function ajaxSetupRequirement() {

            $.ajaxSetup({
                beforeSend: function (xhr, settings) {
                    function getCookie(name) {
                        var cookieValue = null;
                        if (document.cookie && document.cookie != '') {
                            var cookies = document.cookie.split(';');
                            for (var i = 0; i < cookies.length; i++) {
                                var cookie = jQuery.trim(cookies[i]);
                                // Does this cookie string begin with the name we want?
                                if (cookie.substring(0, name.length + 1) == (name + '=')) {
                                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                    break;
                                }
                            }
                        }
                        return cookieValue;
                    }

                    if (!(/^http:.*/.test(settings.url) || /^https:.*/.test(settings.url))) {
                        // Only send the token to relative URLs i.e. locally.
                        xhr.setRequestHeader("X-CSRFToken", getCookie('csrftoken'));
                    }
                }
            });


        }


        $(document).ready(function () {
            get_dashboard_content()
            //$('#date_range').daterangepicker({showDropdowns: true, maxDate: new Date()});
            $('#date_range').daterangepicker({ showDropdowns: true, maxDate: new Date() , format:'dd-mm-yy' });

        });


        function get_dashboard_content() {

            date_range = $('#date_range').val();
            get_chart_data()

        }

        function get_chart_data() {


            // ********* Instituition Type   ************

            $.ajax({
                type: 'POST',
                url: '/livestock/get_paravet_performance_dashboard/',

                success: function (data) {

                    var barchart = ''


                    jsonDataList('para_vat_chart_individual', '', 'line', false, true, barchart)
                }

            });


        }


        function geenrate_para_vet_Table(data) {

            $('#para_vet').DataTable().destroy()

            tbody = ''

            for (i = 0; i < data.length; i++) {

                tbody += '<tr> <td>' + data[i][1] + '</td><td>' + data[i][2] + '</td><td>' + data[i][3] + '</td><td>' + data[i][8] + '</td><td>' + data[i][4] + '</td><td>' + data[i][6] + '</td></tr>'

            }

            $('#para_vet').find('tbody').html(tbody)

            var dTablewithData = $('#para_vet').DataTable({
                "retrieve": true,
                "bFilter": true,
                "paging": true,
                "scrollCollapse": true,
                select: true,
                //ordering: true,
                "scrollX": true,
                "sorting": false,
                "bLengthChange": true,
                "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                {#                "dom": '<"wrapper"flipt>',#} // pagination keep top or above instead of below
                {#                "dom": 'lrtip',#} // No filtering input control:
                {#                "dom": '<lf<t>ip>' ,#} //  Length and filter above, information and pagination below table:
                {#                "dom": '<"top"i>rt<"bottom"flp><"clear">',#}
                "dom": 'Blf<t>ip',
                buttons: [{
                    extend: 'excel', text: "Export", title: 'Para Vet List', exportOptions: {
                        columns: ':visible'
                    }
                }],

            });

        }


                var se = [{
        name: 'Population',
        data: [
            ['Shanghai', 24.2],
            ['Beijing', 20.8],
            ['Karachi', 14.9],
            ['Shenzhen', 13.7],
            ['Guangzhou', 13.1],
        ],
        dataLabels: {
            enabled: true,
            rotation: -90,
            color: '#FFFFFF',
            align: 'right',
            format: '{point.y:.1f}', // one decimal
            y: 10, // 10 pixels down from the top
            style: {
                fontSize: '13px',
                fontFamily: 'Verdana, sans-serif'
            }
        }
    }]


        function jsonDataList(divId, titleText, chartType, stackLabelEnabled, plotColumnDatalabelEnabled, dataset) {

            // ******* Total Value of Chart (S) ******
            var dataSum = 0;
{#            if (chartType != 'pie') {#}
{##}
{#                for (var i = 0; i < dataset.total[0].data.length; i++) {#}
{##}
{#                    dataSum += dataset.total[0].data[i]#}
{#                }#}
{##}
{##}
{#                var pcnt = (this.y / dataSum) * 100;#}
{##}
{##}
{#            }#}


            // ******* Total Value of Chart (E) ******

            var chart = {

                type: chartType
            };
            var title = {
                style: {

                    fontSize: '12px',
                    fontWeight: 'bold'

                },
                text: titleText,
            };


            var subtitle = {
                text: ' ',
            };


            var xAxis = {

               // categories: dataset.cat_list,
                categories:             ['Shanghai', 'Beijing',
            'Karachi',
            'Shenzhen',
            'Guangzhou'] ,
                //     tickmarkPlacement: 'on',
                title: {
                    enabled: false
                }
            };

            var yAxis = {

                labels: {
                    enabled: true
                },

                allowDecimals: false,
                min: 0,
                title: {
                    text: 'Total Number',
                    enabled: true,
                },

                stackLabels: {
                    enabled: stackLabelEnabled,
                    style: {
                        // fontWeight: 'bold',
                        color: (Highcharts.theme && Highcharts.theme.textColor) || 'gray'
                    }

                }
            };

            if (chartType == 'pie') {

                var legend = {
                    layout: 'vertical',
                    align: 'right',
                    verticalAlign: 'up',
                    enabled: true
                };

            }

            else {

                var legend = {
                    {#                    layout: 'horizontal',#}
                    {#                    align: 'middle',#}
                    {#                    verticalAlign: 'bottom',#}
                    enabled: false
                };


            }


            if (chartType == 'pie') {
                var tooltip = {
                    pointFormat: '<b>{point.percentage:.1f}%</b>'
                };
            }
            else {

                var tooltip = {

                    pointFormat: '<b>{point.y}</b>'
                };
            }


            if (chartType == 'pie') {

                var series = [{

                    data: dataset
                }];

            }
            else {
                //var series = dataset.total;
                var series = se

            }

            var plotOptions = {

                bar: {
                    colorByPoint: true,
                    allowPointSelect: true,
                    showInLegend: true,

                    stacking: 'normal',
                    dataLabels: {

                        inside: false,
                        align: 'up',
                        enabled: plotColumnDatalabelEnabled,
                        formatter: function () {
                            var pcnt = (this.y / dataSum) * 100;
                            return Highcharts.numberFormat(pcnt, 0) + '%';
                        },
                        color: (Highcharts.theme && Highcharts.theme.dataLabelsColor) || 'black'
                    }


                },

                column: {
                    colorByPoint: true,
                    allowPointSelect: true,
                    showInLegend: true,

                    stacking: 'normal',
                    dataLabels: {
                        enabled: plotColumnDatalabelEnabled,
                        formatter: function () {
                            {#                            var pcnt = (this.y / dataSum) * 100;#}
                            {#                            return Highcharts.numberFormat(pcnt,0) + '%';#}
                            return this.y

                        },
                        color: (Highcharts.theme && Highcharts.theme.dataLabelsColor) || 'black'
                    }


                },

                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: plotColumnDatalabelEnabled,
                        format: '<b>{point.name}</b>: <b>{point.percentage:.1f}%</b>',

                        style: {
                            color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                        }
                    }

                    ,
                    showInLegend: true
                }


            };


            //         }


            var credits = {
                enabled: false,
            };


            var exporting = {
                buttons: {
                    contextButton: {
                        enabled: false
                    }
                }
            };

            var json = {};
            json.chart = chart;
            json.title = title;
            json.subtitle = subtitle;
            json.xAxis = xAxis;
            json.yAxis = yAxis;
            json.legend = legend;
            json.tooltip = tooltip;
            json.series = series;
            json.plotOptions = plotOptions;
            json.credits = credits;
            json.exporting = exporting;

            $('#' + divId).highcharts(json);

        }


    </script>
{% endblock %}
